{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"/Users/rmzlb/Dropbox/Mac (2)/Documents/GitHub/8mvmt-react/node_modules/@babel/runtime/helpers/regeneratorRuntime.js\").default;\n\nvar _asyncToGenerator = require(\"/Users/rmzlb/Dropbox/Mac (2)/Documents/GitHub/8mvmt-react/node_modules/@babel/runtime/helpers/asyncToGenerator.js\").default;\n\nvar _classCallCheck = require(\"/Users/rmzlb/Dropbox/Mac (2)/Documents/GitHub/8mvmt-react/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\n\nvar _createClass = require(\"/Users/rmzlb/Dropbox/Mac (2)/Documents/GitHub/8mvmt-react/node_modules/@babel/runtime/helpers/createClass.js\").default;\n\nvar _inherits = require(\"/Users/rmzlb/Dropbox/Mac (2)/Documents/GitHub/8mvmt-react/node_modules/@babel/runtime/helpers/inherits.js\").default;\n\nvar _createSuper = require(\"/Users/rmzlb/Dropbox/Mac (2)/Documents/GitHub/8mvmt-react/node_modules/@babel/runtime/helpers/createSuper.js\").default;\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.isWalletObj = exports.getInstalledInjectedConnectors = exports.InjectedConnector = void 0;\n\nvar base_1 = require(\"./base\");\n\nvar errors_1 = require(\"../errors\");\n\nvar InjectedConnector = /*#__PURE__*/function (_base_1$Connector) {\n  _inherits(InjectedConnector, _base_1$Connector);\n\n  var _super = _createSuper(InjectedConnector);\n\n  function InjectedConnector(_ref) {\n    var options = _ref.options;\n\n    _classCallCheck(this, InjectedConnector);\n\n    return _super.call(this, {\n      options: options\n    });\n  }\n\n  _createClass(InjectedConnector, [{\n    key: \"available\",\n    value: function available() {\n      this.ensureWallet();\n      return this._wallet !== undefined;\n    }\n  }, {\n    key: \"ready\",\n    value: function () {\n      var _ready = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.ensureWallet();\n\n                if (this._wallet) {\n                  _context.next = 3;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", false);\n\n              case 3:\n                _context.next = 5;\n                return this._wallet.isPreauthorized();\n\n              case 5:\n                return _context.abrupt(\"return\", _context.sent);\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function ready() {\n        return _ready.apply(this, arguments);\n      }\n\n      return ready;\n    }()\n  }, {\n    key: \"connect\",\n    value: function () {\n      var _connect = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this.ensureWallet();\n\n                if (this._wallet) {\n                  _context2.next = 3;\n                  break;\n                }\n\n                throw new errors_1.ConnectorNotFoundError();\n\n              case 3:\n                _context2.prev = 3;\n                _context2.next = 6;\n                return this._wallet.enable();\n\n              case 6:\n                _context2.next = 11;\n                break;\n\n              case 8:\n                _context2.prev = 8;\n                _context2.t0 = _context2[\"catch\"](3);\n                throw new errors_1.UserRejectedRequestError();\n\n              case 11:\n                if (this._wallet.isConnected) {\n                  _context2.next = 13;\n                  break;\n                }\n\n                throw new errors_1.UserRejectedRequestError();\n\n              case 13:\n                return _context2.abrupt(\"return\", this._wallet.account);\n\n              case 14:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[3, 8]]);\n      }));\n\n      function connect() {\n        return _connect.apply(this, arguments);\n      }\n\n      return connect;\n    }()\n  }, {\n    key: \"disconnect\",\n    value: function () {\n      var _disconnect = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var _this$_wallet;\n\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                this.ensureWallet();\n\n                if (this.available()) {\n                  _context3.next = 3;\n                  break;\n                }\n\n                throw new errors_1.ConnectorNotFoundError();\n\n              case 3:\n                if ((_this$_wallet = this._wallet) !== null && _this$_wallet !== void 0 && _this$_wallet.isConnected) {\n                  _context3.next = 5;\n                  break;\n                }\n\n                throw new errors_1.UserNotConnectedError();\n\n              case 5:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function disconnect() {\n        return _disconnect.apply(this, arguments);\n      }\n\n      return disconnect;\n    }()\n  }, {\n    key: \"account\",\n    value: function () {\n      var _account = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                this.ensureWallet();\n\n                if (this._wallet) {\n                  _context4.next = 3;\n                  break;\n                }\n\n                throw new errors_1.ConnectorNotConnectedError();\n\n              case 3:\n                return _context4.abrupt(\"return\", this._wallet.account);\n\n              case 4:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function account() {\n        return _account.apply(this, arguments);\n      }\n\n      return account;\n    }()\n  }, {\n    key: \"id\",\n    value: function id() {\n      this.ensureWallet();\n\n      if (!this._wallet) {\n        throw new errors_1.ConnectorNotConnectedError();\n      }\n\n      return this._wallet.id;\n    }\n  }, {\n    key: \"name\",\n    value: function name() {\n      this.ensureWallet();\n\n      if (!this._wallet) {\n        throw new errors_1.ConnectorNotConnectedError();\n      }\n\n      return this._wallet.name;\n    }\n  }, {\n    key: \"ensureWallet\",\n    value: function ensureWallet() {\n      var installed = getInstalledWallets();\n      var wallet = installed[this.options.id];\n\n      if (wallet) {\n        this._wallet = wallet;\n      }\n    }\n  }]);\n\n  return InjectedConnector;\n}(base_1.Connector);\n\nexports.InjectedConnector = InjectedConnector;\n\nfunction getInstalledInjectedConnectors() {\n  var installed = Object.keys(getInstalledWallets());\n  var shuffled = shuffle(installed);\n  return shuffled.map(function (id) {\n    return new InjectedConnector({\n      options: {\n        id: id\n      }\n    });\n  });\n}\n\nexports.getInstalledInjectedConnectors = getInstalledInjectedConnectors; // The code below comes from get-starknet and it's just to show what\n// we need from that library\n\nfunction getInstalledWallets() {\n  // no browser wallets on server\n  if (typeof window === 'undefined') {\n    return {};\n  }\n\n  return Object.getOwnPropertyNames(window).reduce(function (wallets, key) {\n    if (key.startsWith('starknet')) {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      var wallet = window[key];\n\n      if ((0, exports.isWalletObj)(key, wallet) && !wallets[wallet.id]) {\n        wallets[wallet.id] = wallet;\n      }\n    }\n\n    return wallets;\n  }, {});\n} // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n\nvar isWalletObj = function isWalletObj(key, wallet) {\n  try {\n    if (wallet && [// wallet's must have methods/members, see IStarknetWindowObject\n    'request', 'isConnected', 'provider', 'enable', 'isPreauthorized', 'on', 'off', 'version'].every(function (key) {\n      return key in wallet;\n    })) {\n      if (key === 'starknet' && (!wallet.id || !wallet.name || !wallet.icon)) {\n        wallet.name = 'Argent X';\n        wallet.icon = '';\n      } // test for new fields only after attempting\n      // to enrich the legacy wallet ->\n\n\n      return ['id', 'name', 'icon'].every(function (key) {\n        return key in wallet;\n      });\n    } // eslint-disable-next-line no-empty\n\n  } catch (err) {}\n\n  return false;\n};\n\nexports.isWalletObj = isWalletObj; // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\nvar shuffle = function shuffle(arr) {\n  for (var i = arr.length - 1; i > 0; i--) {\n    var j = Math.floor(Math.random() * (i + 1));\n    var _ref2 = [arr[j], arr[i]];\n    arr[i] = _ref2[0];\n    arr[j] = _ref2[1];\n  }\n\n  return arr;\n};","map":{"version":3,"mappings":"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","names":["InjectedConnector","options","ensureWallet","_wallet","undefined","isPreauthorized","errors_1","enable","isConnected","account","available","id","name","installed","getInstalledWallets","wallet","base_1","exports","getInstalledInjectedConnectors","Object","keys","shuffled","shuffle","map","window","getOwnPropertyNames","reduce","wallets","key","startsWith","isWalletObj","every","icon","err","arr","i","length","j","Math","floor","random"],"sources":["../../src/connectors/injected.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}