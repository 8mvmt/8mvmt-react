{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"/Users/rmzlb/Dropbox/Mac (2)/Documents/GitHub/8mvmt-react/node_modules/@babel/runtime/helpers/regeneratorRuntime.js\").default;\n\nvar _createForOfIteratorHelper = require(\"/Users/rmzlb/Dropbox/Mac (2)/Documents/GitHub/8mvmt-react/node_modules/@babel/runtime/helpers/createForOfIteratorHelper.js\").default;\n\nvar _asyncToGenerator = require(\"/Users/rmzlb/Dropbox/Mac (2)/Documents/GitHub/8mvmt-react/node_modules/@babel/runtime/helpers/asyncToGenerator.js\").default;\n\nvar _slicedToArray = require(\"/Users/rmzlb/Dropbox/Mac (2)/Documents/GitHub/8mvmt-react/node_modules/@babel/runtime/helpers/slicedToArray.js\").default;\n\nvar _objectSpread = require(\"/Users/rmzlb/Dropbox/Mac (2)/Documents/GitHub/8mvmt-react/node_modules/@babel/runtime/helpers/objectSpread2.js\").default;\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.useStarknetExecute = void 0;\n\nvar react_1 = require(\"react\");\n\nvar __1 = require(\"..\");\n\nfunction starknetExecuteReducer(state, action) {\n  if (action.type === 'start_execute') {\n    return _objectSpread(_objectSpread({}, state), {}, {\n      loading: true\n    });\n  } else if (action.type === 'set_execute_response') {\n    return _objectSpread(_objectSpread({}, state), {}, {\n      data: action.data.transaction_hash,\n      error: undefined,\n      loading: false\n    });\n  } else if (action.type === 'set_execute_error') {\n    return _objectSpread(_objectSpread({}, state), {}, {\n      error: action.error,\n      loading: false\n    });\n  } else if (action.type === 'reset') {\n    return _objectSpread(_objectSpread({}, state), {}, {\n      data: undefined,\n      error: undefined,\n      loading: false\n    });\n  }\n\n  return state;\n}\n\nfunction useStarknetExecute(_ref) {\n  var calls = _ref.calls,\n      metadata = _ref.metadata;\n\n  var _ref2 = (0, __1.useStarknetTransactionManager)(),\n      addTransaction = _ref2.addTransaction;\n\n  var _ref3 = (0, react_1.useReducer)(starknetExecuteReducer, {\n    loading: false\n  }),\n      _ref4 = _slicedToArray(_ref3, 2),\n      state = _ref4[0],\n      dispatch = _ref4[1];\n\n  var _ref5 = (0, __1.useStarknet)(),\n      accountAddress = _ref5.account,\n      connectors = _ref5.connectors;\n\n  var reset = (0, react_1.useCallback)(function () {\n    dispatch({\n      type: 'reset'\n    });\n  }, [dispatch]);\n  var execute = (0, react_1.useCallback)( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n    var accountInterface, _iterator, _step, connector, account, response, message;\n\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (!calls) {\n              _context.next = 38;\n              break;\n            }\n\n            _context.prev = 1;\n            accountInterface = null;\n            _iterator = _createForOfIteratorHelper(connectors);\n            _context.prev = 4;\n\n            _iterator.s();\n\n          case 6:\n            if ((_step = _iterator.n()).done) {\n              _context.next = 16;\n              break;\n            }\n\n            connector = _step.value;\n            _context.next = 10;\n            return connector.account();\n\n          case 10:\n            account = _context.sent;\n\n            if (!(account.address === accountAddress)) {\n              _context.next = 14;\n              break;\n            }\n\n            accountInterface = account;\n            return _context.abrupt(\"break\", 16);\n\n          case 14:\n            _context.next = 6;\n            break;\n\n          case 16:\n            _context.next = 21;\n            break;\n\n          case 18:\n            _context.prev = 18;\n            _context.t0 = _context[\"catch\"](4);\n\n            _iterator.e(_context.t0);\n\n          case 21:\n            _context.prev = 21;\n\n            _iterator.f();\n\n            return _context.finish(21);\n\n          case 24:\n            if (accountInterface) {\n              _context.next = 26;\n              break;\n            }\n\n            throw new Error(\"No connector for address \".concat(accountAddress));\n\n          case 26:\n            dispatch({\n              type: 'start_execute'\n            });\n            _context.next = 29;\n            return accountInterface.execute(calls);\n\n          case 29:\n            response = _context.sent;\n            dispatch({\n              type: 'set_execute_response',\n              data: response\n            }); // start tracking the transaction\n\n            addTransaction({\n              status: response.code,\n              transactionHash: response.transaction_hash,\n              metadata: metadata\n            });\n            _context.next = 38;\n            break;\n\n          case 34:\n            _context.prev = 34;\n            _context.t1 = _context[\"catch\"](1);\n            message = _context.t1 instanceof Error ? _context.t1.message : String(_context.t1);\n            dispatch({\n              type: 'set_execute_error',\n              error: message\n            });\n\n          case 38:\n            return _context.abrupt(\"return\", undefined);\n\n          case 39:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[1, 34], [4, 18, 21, 24]]);\n  })), [accountAddress, connectors, addTransaction, calls, metadata]);\n  return {\n    data: state.data,\n    loading: state.loading,\n    error: state.error,\n    reset: reset,\n    execute: execute\n  };\n}\n\nexports.useStarknetExecute = useStarknetExecute;","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;AAAA;;AAGA;;AA4BA,SAASA,sBAAT,CAAgCC,KAAhC,EAA8CC,MAA9C,EAA4D;EAC1D,IAAIA,MAAM,CAACC,IAAP,KAAgB,eAApB,EAAqC;IACnC,uCACKF,KADL;MAEEG,OAAO,EAAE;IAFX;EAID,CALD,MAKO,IAAIF,MAAM,CAACC,IAAP,KAAgB,sBAApB,EAA4C;IACjD,uCACKF,KADL;MAEEI,IAAI,EAAEH,MAAM,CAACG,IAAP,CAAYC,gBAFpB;MAGEC,KAAK,EAAEC,SAHT;MAIEJ,OAAO,EAAE;IAJX;EAMD,CAPM,MAOA,IAAIF,MAAM,CAACC,IAAP,KAAgB,mBAApB,EAAyC;IAC9C,uCACKF,KADL;MAEEM,KAAK,EAAEL,MAAM,CAACK,KAFhB;MAGEH,OAAO,EAAE;IAHX;EAKD,CANM,MAMA,IAAIF,MAAM,CAACC,IAAP,KAAgB,OAApB,EAA6B;IAClC,uCACKF,KADL;MAEEI,IAAI,EAAEG,SAFR;MAGED,KAAK,EAAEC,SAHT;MAIEJ,OAAO,EAAE;IAJX;EAMD;;EACD,OAAOH,KAAP;AACD;;AAsBD,SAAgBQ,kBAAhB,OAA8E;EAAA,IAAzCC,KAAyC,QAAzCA,KAAyC;EAAA,IAAlCC,QAAkC,QAAlCA,QAAkC;;EAC5E,YAA2B,wCAA3B;EAAA,IAAQC,cAAR,SAAQA,cAAR;;EACA,YAA0B,wBAAWZ,sBAAX,EAAmC;IAC3DI,OAAO,EAAE;EADkD,CAAnC,CAA1B;EAAA;EAAA,IAAOH,KAAP;EAAA,IAAcY,QAAd;;EAIA,YAAgD,sBAAhD;EAAA,IAAiBC,cAAjB,SAAQC,OAAR;EAAA,IAAiCC,UAAjC,SAAiCA,UAAjC;;EAEA,IAAMC,KAAK,GAAG,yBAAY,YAAK;IAC7BJ,QAAQ,CAAC;MAAEV,IAAI,EAAE;IAAR,CAAD,CAAR;EACD,CAFa,EAEX,CAACU,QAAD,CAFW,CAAd;EAIA,IAAMK,OAAO,GAAG,kGAAY;IAAA;;IAAA;MAAA;QAAA;UAAA;YAAA,KACtBR,KADsB;cAAA;cAAA;YAAA;;YAAA;YAGlBS,gBAHkB,GAG0B,IAH1B;YAAA,uCAIEH,UAJF;YAAA;;YAAA;;UAAA;YAAA;cAAA;cAAA;YAAA;;YAIXI,SAJW;YAAA;YAAA,OAKEA,SAAS,CAACL,OAAV,EALF;;UAAA;YAKdA,OALc;;YAAA,MAMhBA,OAAO,CAACM,OAAR,KAAoBP,cANJ;cAAA;cAAA;YAAA;;YAOlBK,gBAAgB,GAAGJ,OAAnB;YAPkB;;UAAA;YAAA;YAAA;;UAAA;YAAA;YAAA;;UAAA;YAAA;YAAA;;YAAA;;UAAA;YAAA;;YAAA;;YAAA;;UAAA;YAAA,IAWjBI,gBAXiB;cAAA;cAAA;YAAA;;YAAA,MAYd,IAAIG,KAAJ,oCAAsCR,cAAtC,EAZc;;UAAA;YActBD,QAAQ,CAAC;cAAEV,IAAI,EAAE;YAAR,CAAD,CAAR;YAdsB;YAAA,OAeCgB,gBAAgB,CAACD,OAAjB,CAAyBR,KAAzB,CAfD;;UAAA;YAehBa,QAfgB;YAgBtBV,QAAQ,CAAC;cAAEV,IAAI,EAAE,sBAAR;cAAgCE,IAAI,EAAEkB;YAAtC,CAAD,CAAR,CAhBsB,CAiBtB;;YACAX,cAAc,CAAC;cACbY,MAAM,EAAED,QAAQ,CAACE,IADJ;cAEbC,eAAe,EAAEH,QAAQ,CAACjB,gBAFb;cAGbK,QAAQ,EAARA;YAHa,CAAD,CAAd;YAlBsB;YAAA;;UAAA;YAAA;YAAA;YAwBhBgB,OAxBgB,GAwBN,uBAAeL,KAAf,GAAuB,YAAIK,OAA3B,GAAqCC,MAAM,aAxBrC;YAyBtBf,QAAQ,CAAC;cAAEV,IAAI,EAAE,mBAAR;cAA6BI,KAAK,EAAEoB;YAApC,CAAD,CAAR;;UAzBsB;YAAA,iCA4BnBnB,SA5BmB;;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAZ,IA6Bb,CAACM,cAAD,EAAiBE,UAAjB,EAA6BJ,cAA7B,EAA6CF,KAA7C,EAAoDC,QAApD,CA7Ba,CAAhB;EA+BA,OAAO;IAAEN,IAAI,EAAEJ,KAAK,CAACI,IAAd;IAAoBD,OAAO,EAAEH,KAAK,CAACG,OAAnC;IAA4CG,KAAK,EAAEN,KAAK,CAACM,KAAzD;IAAgEU,KAAK,EAALA,KAAhE;IAAuEC,OAAO,EAAPA;EAAvE,CAAP;AACD;;AA5CDW","names":["starknetExecuteReducer","state","action","type","loading","data","transaction_hash","error","undefined","useStarknetExecute","calls","metadata","addTransaction","dispatch","accountAddress","account","connectors","reset","execute","accountInterface","connector","address","Error","response","status","code","transactionHash","message","String","exports"],"sources":["../../src/hooks/execute.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}